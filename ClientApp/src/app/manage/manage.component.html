<div class="container-fluid">
  <div class="row">
    <div class="col-sm-12">
      <div class="card bg-light mt-2">
        <div class="card-header">Votre ID est: {{currentUser.userId}}  / Agence: {{currentUser.branch}}</div>
        <div class="card-body">

          <div class="row">
            <div class="col-sm-5">
              <h4>Compte</h4>
              <p>Mettez à jour les informations de profil de votre compte</p>
            </div>
            <div class="col-sm-7">
              <form class="card" [formGroup]="userProfileForm"
                    (ngSubmit)="onSubmitProfile()" autocomplete="off">
                <div class="card-body">
                  <div *ngIf="profileError" class="form-group row justify-content-center text-center">
                    <span class="alert-danger">{{profileError}}</span>
                  </div>
                  <div *ngIf="profileSuccess" class="form-group row justify-content-center text-center">
                    <span class="alert-success">{{profileSuccess}}</span>
                  </div>
                  <div class="form-group row">
                    <label class="col-sm-4">Identifiant:</label>
                    <div class="col-sm-8">
                      <input type="text" class="form-control form-control-sm" formControlName="userName"
                             [ngClass]="{
                              'is-invalid': userName.invalid && (userName.dirty || userName.touched)
                            }">
                    </div>
                  </div>
                  <div class="form-group row">
                    <label class="col-sm-4">Nom Complèt:</label>
                    <div class="col-sm-8">
                      <input type="text" class="form-control form-control-sm" formControlName="fullName">
                    </div>
                  </div>
                  <div class="form-group row">
                    <div class="offset-sm-4 col-sm-8">
                      <button type="submit" class="btn btn-sm btn-primary"
                              [disabled]="userProfileForm.invalid || profileLoading">
                        Enregistrer <span class="ml-2 spinner-border spinner-border-sm" *ngIf="profileLoading"></span>
                      </button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>

          <hr>


          <div class="row">
            <div class="col-sm-5">
              <h4>Securité</h4>
              <p>Mettez à jour votre mot de passe</p>
            </div>
            <div class="col-sm-7">
              <form class="card" [formGroup]="changePasswordForm"
                    (ngSubmit)="onSubmitPasword()" autocomplete="off">
                <div class="card-body">
                  <div *ngIf="passwordError" class="form-group row justify-content-center text-center">
                    <span class="alert-danger">{{passwordError}}</span>
                  </div>
                  <div *ngIf="passwordSuccess" class="form-group row justify-content-center text-center">
                    <span class="alert-success">{{passwordSuccess}}</span>
                  </div>
                  <div class="form-group row">
                    <label class="col-sm-4">Ancien Mot de Passe:</label>
                    <div class="col-sm-8">
                      <input [type]="passwordInputType" class="form-control form-control-sm" formControlName="currentPassword"
                             [ngClass]="{
                              'is-invalid': currentPassword.invalid && (currentPassword.dirty || currentPassword.touched),
                              'is-valid': currentPassword.valid
                            }" required>
                      <div class="invalid-feedback">
                        Votre ancien mot de passe est obligatoire
                      </div>
                    </div>
                  </div>
                  <div class="form-group row">
                    <label class="col-sm-4">Nouveau Mot de Passe:</label>
                    <div class="col-sm-8">
                      <input [type]="passwordInputType" class="form-control form-control-sm" formControlName="password"
                             [ngClass]="{
                              'is-invalid': password.invalid && (password.dirty || password.touched),
                              'is-valid': password.valid
                            }">
                      <div class="invalid-feedback">
                        Nouveau Mot de passe est obligatoire
                      </div>
                    </div>
                  </div>
                  <div class="form-group row">
                    <label class="col-sm-4">Confirmer Mot de passe:</label>
                    <div class="col-sm-8">
                      <input [type]="passwordInputType" class="form-control form-control-sm" formControlName="confirmPassword"
                             [ngClass]="{
                              'is-invalid': confirmPassword.invalid && (confirmPassword.dirty || confirmPassword.touched),
                              'is-valid': confirmPassword.valid
                            }" required>
                      <div class="invalid-feedback">
                        Confimez votre nouveau mot de passe
                      </div>
                    </div>
                  </div>
                  <div class="offset-sm-4 col-sm-8 mb-1" *ngIf="changePasswordForm.errors?.passwordMatch && (password.touched || password.dirty)
                   && (confirmPassword.touched || confirmPassword.dirty) "
                       style="font-size: 80%; color: #dc3545;">
                    Les nouveaux mots de passe ne se correspondent pas
                  </div>
                  <div class="offset-sm-4 col-sm-8">
                    <div class="checkbox p-2">
                      <label for="showPassword">
                        <input id="showPassword" type="checkbox" (change)="onShowPassword($event.target.checked)"> Afficher le mot de passe
                      </label>
                    </div>
                  </div>


                  <div class="form-group row">
                    <div class="offset-sm-4 col-sm-8">
                      <button type="submit" class="btn btn-sm btn-primary"
                              [disabled]="changePasswordForm.invalid || passwordLoading">
                        Enregistrer <span class="ml-2 spinner-border spinner-border-sm" *ngIf="passwordLoading"></span>
                      </button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>


        </div>
      </div>
    </div>
  </div>
  

  


</div>
